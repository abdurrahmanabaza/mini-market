<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</title>
<!-- Ø¥Ø¶Ø§ÙØ© Ø®Ø· Ù…Ù† Google Fonts ÙŠØ¯Ø¹Ù… Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© -->
<link href="https://fonts.googleapis.com/css2?family=Cairo&display=swap" rel="stylesheet" />
<link rel="icon" href="images/icon.jpg">
<style>
  /* Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© */
  * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
  }
  body {
      font-family: 'Cairo', Arial, Tahoma, sans-serif;
      background-color: #f8f9fa;
      color: #333;
      line-height: 1.6;
      margin-top: 60px;
      position: relative;
  }
  header {
      position: fixed; 
      width: 100%;
      background-color: #007bff;
      color: #fff;
      padding: 10px 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 14px;
      top: 0px;
      z-index: 999;
  }
  header h1 {
      font-size: 1.2em;
  }
  /* Ø²Ø± Ø§Ù„Ù…Ø¯ÙŠØ± */
#adminFixedBtn {
    display: none;
    position: fixed;
    bottom: 0;
    right: 7px;
    width: 15px;
    height: 8px;
    padding: 6px 10px;
    background-color: transparent;
    border: 1px solid #ccc;
    border-radius: 4px;
    font-family: 'Cairo', Arial, Tahoma, sans-serif;
    font-size: 4px;
    cursor: pointer;
    color: #555;
    transition: background-color 0.3s, color 0.3s;
}
#adminFixedBtn:hover {
    background-color: #eee;
    color: #000;
}
/* Ø²Ø± Ø§Ù„Ø³Ù„Ø© */
#cartFloatingButton {
    position: fixed;
    bottom: 22px;
    left: 15px;
    background-color: #0f7b5a;
    color: #fff;
    padding: 12px 20px;
    border-radius: 50px;
    border: none;
    cursor: pointer;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    font-size: 16px;
    display: flex;
    align-items: center;
    transition: background-color 0.3s;
}
#cartFloatingButton:hover {
    background-color: #388E3C;
}
/* Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù„Ù„Ù…Ø¯ÙŠØ± */
#adminPanel {
    display: none; 
    position: fixed; 
    top: 50px; 
    right: 50px; 
    background: #fff; 
    padding: 20px; 
    border-radius: 8px; 
    max-height: 80%; 
    overflow: auto; 
    z-index: 9999; 
    width: 90%; 
    max-width: 900px;
}
/* Ø£Ø²Ø±Ø§Ø± +/- */
.quantity-controls button {
    padding: 5px 10px;
    font-size: 1em;
    border: none;
    background-color: #007bff;
    color: #fff;
    border-radius: 4px;
    cursor: pointer;
    margin: 0 5px;
    transition: background-color 0.3s;
}
.quantity-controls button:hover {
    background-color: #0056b3;
}
/* Ù…Ø±Ø¨Ø¹ Ø§Ù„ÙƒÙ…ÙŠØ© */
#qtyInput {
    width: 40px;
    height: 30px;
    text-align: center;
    border: 1px solid #ccc;
    border-radius: 4px;
    margin: 0 5px;
    font-size: 1em;
}
/* Ø§Ù„ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© */
* {
    box-sizing: border-box;
}
body {
    font-family: 'Cairo', Arial, Tahoma, sans-serif;
    background-color: #f8f9fa;
    color: #333;
    line-height: 1.6;
}
header {
    background-color: #007bff;
    color: #fff;
    padding: 10px 20px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 14px;
}
header h1 {
    font-size: 1.2em;
}
#searchInput {
    display: flex;
    position: fixed; 
    top: 52px;
    left: 30px;
    margin-bottom: 15px;
    width: 90%;
    max-width: 300px;
    padding: 13px 17px;
    font-size: 16px;
    border-radius: 25px;
    border: 2px solid #007bff;
    outline: none;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
}
#searchInput:focus {
    border-color: #0056b3;
    box-shadow: 0 6px 12px rgba(0,0,0,0.2);
}
.products {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    justify-content: center;
    margin-top: 100px;
}
.product {
    background-color: #fff;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    width: 100%;
    max-width: 300px;
    padding: 15px;
    transition: transform 0.2s;
    text-align: center;
}
.product:hover {
    transform: scale(1.02);
}
.product h3 {
    margin-bottom: 10px;
    font-size: 1.2em;
}
.price {
    color: #e60000;
    font-weight: bold;
    margin-bottom: 10px;
}
.quantity-controls {
    display: flex;
    justify-content: center;
    align-items: center;
    margin-bottom: 10px;
}
.btn {
    display: inline-block;
    padding: 10px 15px;
    background-color: #007bff;
    color: #fff;
    border-radius: 5px;
    text-decoration: none;
    transition: background-color 0.3s;
    margin-top: 10px;
}
.btn:hover {
    background-color: #0056b3;
}
footer {
    background-color: #343a40;
    color: #fff;
    padding: 20px;
    text-align: center;
    margin-top: 40px;
}
#cartContainer {
    margin-top: 40px;
}
#cartItems {
    list-style: none;
    padding: 0;
    max-width: 600px;
    margin: auto;
}
#cartItems li {
    padding: 10px;
    border-bottom: 1px solid #ccc;
    margin-bottom: 10px;
    background-color: #fff;
    border-radius: 8px;
}
#totalPrice {
    text-align: right;
    font-weight: bold;
    margin-top: 15px;
    font-size: 1.2em;
}
#cartPage {
    display: none;
    padding: 20px;
}
#cartPage.active {
    display: block;
}
#orderForm {
    display: none;
    margin-top: 20px;
}
#orderForm.active {
    display: block;
}
</style>
</head>
<body>
<header>
    <h1>Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</h1>
</header>

<!-- Ø²Ø± Ø§Ù„Ù…Ø¯ÙŠØ± ÙŠØ¸Ù‡Ø± Ø¹Ù†Ø¯ Ø§Ù„Ù†Ø²ÙˆÙ„ Ù„Ø£Ø³ÙÙ„ -->
<button id="adminFixedBtn" onclick="promptAdmin()">ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø¯ÙŠØ±</button>

<!-- Ø²Ø± Ø§Ù„Ø³Ù„Ø© Ø¹Ø§Ø¦Ù… -->
<button id="cartFloatingButton" onclick="showCartPage()">
    ğŸ›’ Ø§Ù„Ø³Ù„Ø© <span id="cartCount">0</span>
</button>

<!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
<div id="mainContent" class="container">
    <h2 style="text-align:center; margin-bottom: 14px; margin-top: 8px;">Ù…Ù†ØªØ¬Ø§ØªÙ†Ø§</h2>
    <div class="search-container">
        <input type="text" id="searchInput" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬..." />
        <!-- ØªÙ… Ø­Ø°Ù Ø²Ø± ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
    </div>
    <div class="products" id="productsContainer"></div>
</div>

<!-- ØµÙØ­Ø© Ø§Ù„Ø³Ù„Ø© -->
<div id="cartPage">
    <h2 style="text-align:center;">Ø§Ù„Ø³Ù„Ø©</h2>
    <ul id="cartItems"></ul>
    <div id="totalPrice">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: 0 Ù„.Ø³</div>
    <button onclick="showMain()" style="margin-top:15px; padding:10px 20px; background-color:#007bff; color:#fff; border:none; border-radius:4px; cursor:pointer;">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…Ù†ØªØ¬Ø§Øª</button>
    <button id="confirmOrderBtn" style="margin-top:15px; padding:10px 20px; background-color:#28a745; color:#fff; border:none; border-radius:4px; cursor:pointer;">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨</button>
</div>

<!-- Ø­Ù‚Ù„ Ø§Ù„ØªÙˆØµÙŠÙ„ -->
<div id="orderForm">
    <h3>Ø§Ù…Ù„Ø£ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªÙˆØµÙŠÙ„</h3>
    <label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</label>
    <input type="text" id="deliveryAddress" placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù†Ùƒ" />
    <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ:</label>
    <input type="text" id="phoneNumber" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙÙƒ" />
</div>

<!-- Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù„Ù„Ù…Ø¯ÙŠØ± -->
<div id="adminPanel" style="display:none;">
    <h3>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h3>
    <div id="adminProducts"></div>
    <button onclick="addProduct()">Ø¥Ø¶Ø§ÙØ© Ù…Ø§Ø¯Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
    <button onclick="closeAdmin()">Ø¥ØºÙ„Ø§Ù‚</button>
</div>

<!-- Ø­Ù‚ÙˆÙ‚ Ø§Ù„Ù†Ø´Ø± -->
<footer>
    <p>Â© 2025 Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</p>
</footer>

<script>
const items = [
  { id: 1, name: "Ø³ÙƒØ± ÙØ±Ø·", image: "images/suger.jpg" },
  { id: 2, name: "Ù…Ù„Ø­", image: "images/sult.jpg" },
  { id: 3, name: "Ø¨ÙŠØ¶", image: "images/egg.jpg" }
  // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ù‡Ù†Ø§
];

let cart = [];
let filteredItems = [...items];

async function loadData() {
  try {
    const res = await fetch('data.json');
    const externalData = await res.json();
    // Ø¯Ù…Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ù…Ù„Ù json Ù…Ø¹ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©
    items.forEach(product => {
      const data = externalData.find(d => d.id === product.id || d.name === product.name);
      if (data) {
        product.value = data.value;
        product.quantity = data.quantity;
      } else {
        // Ø¥Ø°Ø§ Ù„Ù… ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§ØªØŒ ÙŠÙ…ÙƒÙ† Ø¥Ø¹Ø·Ø§Ø¡ Ù‚ÙŠÙ… Ø§ÙØªØ±Ø§Ø¶ÙŠØ©
        if (product.value === undefined) product.value = 100;
        if (product.quantity === undefined) product.quantity = 0;
      }
    });
    renderProducts();
  } catch (e) {
    console.error("ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:", e);
    // ÙÙŠ Ø­Ø§Ù„ ÙØ´Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„ØŒ Ø§Ø³ØªÙ…Ø± Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø­Ø§Ù„ÙŠØ©
    renderProducts();
  }
}

window.onload = () => {
  loadData();
}

function renderProducts() {
  const container = document.getElementById('productsContainer');
  container.innerHTML = '';
  filteredItems.forEach((item, index) => {
    const realIndex = items.indexOf(item);
    const div = document.createElement('div');
    div.className='product';
    div.innerHTML = `
      <img src="${item.image}" alt="${item.name}" style="width:auto; height:98px; border-radius:8px; margin-bottom:15px; margin: 0 auto; display: block;">
      <h3>${item.name}</h3>
      <p class="price">Ø§Ù„Ø³Ø¹Ø±: ${item.value.toLocaleString()} Ù„.Ø³</p>
      <div class="quantity-controls">
        <button onclick="decreaseQty(${realIndex})">-</button>
        <input type="text" id="qtyInput${realIndex}" value="1" readonly />
        <button onclick="increaseQty(${realIndex}, ${item.quantity})">+</button>
      </div>
      <a href="#" class="btn" onclick="addToCart(event, ${realIndex})">Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©</a>
    `;
    container.appendChild(div);
  });
}

document.getElementById('searchInput').addEventListener('input', () => {
  const q = document.getElementById('searchInput').value.trim().toLowerCase();
  if (q === "") {
    filteredItems = [...items];
  } else {
    filteredItems = items.filter(i => i.name.toLowerCase().includes(q));
  }
  renderProducts();
});

function increaseQty(index, max) {
  const input = document.getElementById(`qtyInput${index}`);
  let val = parseInt(input.value);
  if (val < max) {
    input.value = val + 1;
  } else {
    alert('Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø´Ø±Ø§Ø¡ Ø£ÙƒØ«Ø± Ù…Ù† Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…ØªÙˆÙØ±Ø©');
  }
}

function decreaseQty(index) {
  const input = document.getElementById(`qtyInput${index}`);
  let val = parseInt(input.value);
  if (val > 1) {
    input.value = val - 1;
  }
}

function addToCart(e, index) {
  e.preventDefault();
  const qty = parseInt(document.getElementById(`qtyInput${index}`).value);
  const item = items[index];
  const existingIndex = cart.findIndex(c => c.index === index);
  if (existingIndex !== -1) {
    if (cart[existingIndex].quantity + qty <= item.quantity) {
      cart[existingIndex].quantity += qty;
    } else {
      alert('Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© ØªØªØ¬Ø§ÙˆØ² Ø§Ù„ÙƒÙ…ÙŠØ© Ø§Ù„Ù…ØªÙˆÙØ±Ø©');
      return;
    }
  } else {
    cart.push({ index, name: item.name, value: item.value, quantity: qty, max: item.quantity });
  }
  updateCartCount();
  alert('ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬ Ø¥Ù„Ù‰ Ø§Ù„Ø³Ù„Ø©');
}

function updateCartCount() {
  const totalItems = cart.reduce((sum, c) => sum + c.quantity, 0);
  document.getElementById('cartCount').innerText = totalItems;
}

function showCartPage() {
  document.getElementById('mainContent').style.display='none';
  document.getElementById('cartPage').style.display='block';
  renderCart();
  document.getElementById('orderForm').classList.remove('active');
}

function showMain() {
  document.getElementById('mainContent').style.display='block';
  document.getElementById('cartPage').style.display='none';
  document.getElementById('orderForm').classList.remove('active');
}

function renderCart() {
  const container = document.getElementById('cartItems');
  container.innerHTML = '';
  let total = 0;
  cart.forEach((item, index) => {
    total += item.value * item.quantity;
    const li = document.createElement('li');
    li.innerHTML = `
      <strong>${item.name}</strong><br/>
      Ø§Ù„Ø³Ø¹Ø±: ${item.value.toLocaleString()} Ù„.Ø³<br/>
      Ø§Ù„ÙƒÙ…ÙŠØ©: ${item.quantity} <br/>
      <button onclick="removeFromCart(${index})" style="margin-top:5px; padding:5px 10px; background-color:#e60000; color:#fff; border:none; border-radius:4px; cursor:pointer;">Ø­Ø°Ù</button>
    `;
    container.appendChild(li);
  });
  document.getElementById('totalPrice').innerText = `Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: ${total.toLocaleString()} Ù„.Ø³`;
}

function removeFromCart(i) {
  cart.splice(i,1);
  renderCart();
  updateCartCount();
}

document.getElementById('confirmOrderBtn').addEventListener('click', () => {
  if (cart.length === 0) {
      alert('Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©');
      return;
  }
  document.getElementById('orderForm').classList.add('active');
  document.getElementById('cartPage').style.display='none';
});

document.querySelector('#confirmOrderBtn').addEventListener('click', () => {
  const address = document.getElementById('deliveryAddress').value.trim();
  const phone = document.getElementById('phoneNumber').value.trim();
  if (!address || !phone) {
      alert('ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ');
      return;
  }
  let message = 'Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯:\n';
  let total = 0;
  cart.forEach(item => {
      total += item.value * item.quantity;
      message += `${item.name} Ã— ${item.quantity}\n`;
  });
  message += `Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€\n`;
  message += `Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: ${total.toLocaleString()} Ù„.Ø³\n`;
  message += `\nØ§Ù„Ø¹Ù†ÙˆØ§Ù†: ${address}\n`;
  message += `Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: ${phone}\n`;
  const encodedMessage = encodeURIComponent(message);
  const whatsappNumber = '+963936421060';
  const whatsappURL = `https://wa.me/${whatsappNumber}?text=${encodedMessage}`;
  window.open(whatsappURL, '_blank');
  document.getElementById('deliveryAddress').value = '';
  document.getElementById('phoneNumber').value = '';
  document.getElementById('orderForm').classList.remove('active');
  showMain();
});

// Ø²Ø± ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø¯ÙŠØ± Ø¹Ù†Ø¯ Ø§Ù„Ù†Ø²ÙˆÙ„ Ù„Ø£Ø³ÙÙ„
const adminBtn = document.getElementById('adminFixedBtn');
window.addEventListener('scroll', () => {
  if (window.scrollY > 300) {
      adminBtn.style.display = 'block';
  } else {
      adminBtn.style.display = 'none';
  }
});

function promptAdmin() {
  const pw = prompt('Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø³Ø± Ø§Ù„Ù…Ø¯ÙŠØ±:');
  if (pw === 'admin123') {
      document.getElementById('adminPanel').style.display='block';
      renderAdminProducts();
  } else {
      alert('ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
  }
}

function renderAdminProducts() {
  const container = document.getElementById('adminProducts');
  container.innerHTML = '';
  items.forEach((item, i) => {
      container.innerHTML += `
      <div style="border:1px solid #ccc; padding:10px; margin-bottom:10px; border-radius:5px;">
          <input style="width:100%; margin-bottom:5px;" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬" onchange="items[${i}].name=this.value" value="${item.name}"/>
          <input style="width:100%; margin-bottom:5px;" type="number" placeholder="Ø§Ù„Ø³Ø¹Ø±" onchange="items[${i}].value=Number(this.value)" value="${item.value}"/>
          <input style="width:100%; margin-bottom:5px;" type="number" placeholder="Ø§Ù„ÙƒÙ…ÙŠØ©" onchange="items[${i}].quantity=Number(this.value)" value="${item.quantity}"/>
          <button onclick="deleteItem(${i})" style="background:#e60000; color:#fff; border:none; padding:5px 8px; border-radius:4px; cursor:pointer;">Ø­Ø°Ù</button>
      </div>
      `;
  });
}

function addProduct() {
  items.push({name:'Ù…Ø§Ø¯Ø© Ø¬Ø¯ÙŠØ¯Ø©', value:100, quantity:100});
  renderAdminProducts();
  renderProducts();
}

function deleteItem(i) {
  items.splice(i,1);
  renderAdminProducts();
  renderProducts();
}

function closeAdmin() {
  document.getElementById('adminPanel').style.display='none';
}
</script>
</body>
</html>
