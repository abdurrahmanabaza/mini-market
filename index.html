<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>متجر صغير</title>
<style>
  /* بعض التنسيقات الأساسية */
  body {
    font-family: Arial, sans-serif;
    padding: 20px;
  }
  #products {
    display: flex;
    flex-wrap: wrap;
  }
  .product {
    border: 1px solid #ccc;
    padding: 10px;
    margin: 10px;
    width: 200px;
  }
  .product button {
    margin-top: 10px;
  }
</style>
</head>
<body>

<h1>متجر المنتجات</h1>
<div id="products"></div>

<script>
  // البيانات الأولية للمنتجات
  let items = [
    { id: 1, name: 'تفاح', price: 3, quantity: 0, value: 0 },
    { id: 2, name: 'موز', price: 2, quantity: 0, value: 0 },
    { id: 3, name: 'برتقال', price: 4, quantity: 0, value: 0 }
  ];

  // البيانات الخارجية (مثلاً من ملف JSON)
  let externalData = [];

  // وظيفة لعرض المنتجات
  function renderProducts() {
    const container = document.getElementById('products');
    container.innerHTML = '';

    items.forEach(item => {
      const productDiv = document.createElement('div');
      productDiv.className = 'product';

      productDiv.innerHTML = `
        <h3>${item.name}</h3>
        <p>السعر: ${item.price} ريال</p>
        <p>الكمية: ${item.quantity}</p>
        <p>القيمة: ${item.value} ريال</p>
        <button onclick="updateQuantity(${item.id}, 1)">زيادة</button>
        <button onclick="updateQuantity(${item.id}, -1)">نقصان</button>
      `;

      container.appendChild(productDiv);
    });
  }

  // وظيفة لتحديث الكمية
  function updateQuantity(id, delta) {
    const item = items.find(i => i.id === id);
    if (item) {
      item.quantity += delta;
      if (item.quantity < 0) item.quantity = 0;
      // تحديث القيمة
      item.value = item.quantity * item.price;
      renderProducts();
    }
  }

  // وظيفة لتحميل البيانات الخارجية (محاكاة)
  async function loadData() {
    try {
      // هنا يمكنك استبدال الرابط برابط حقيقي أو تحميل بيانات من ملف
      // على سبيل المثال: const res = await fetch('externalData.json');
      // const data = await res.json();
      
      // بيانات خارجية نموذجية
      externalData = [
        { name: 'تفاح', quantity: 10, value: 30 },
        { name: 'موز', quantity: 5, value: 10 },
        { name: 'برتقال', quantity: 8, value: 32 }
      ];

      // دمج البيانات الخارجية مع عناصر المنتجات
      items = items.map(item => {
        const match = externalData.find(d => d.name === item.name);
        return {
          ...item,
          quantity: match?.quantity ?? 0,
          value: match?.value ?? 0
        };
      });

      renderProducts();
    } catch (e) {
      console.error("فشل تحميل البيانات:", e);
    }
  }

  // تحميل البيانات عند بدء الصفحة
  window.onload = loadData;
</script>

</body>
</html>
